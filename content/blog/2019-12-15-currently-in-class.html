---
title: Currently In Class
author: Michael Wright
date: '2019-12-15'
slug: currently-in-class
categories: []
tags: []
description: ''
---



<div id="needleman-wunsch-algorithm" class="section level2">
<h2><strong>Needleman-Wunsch Algorithm</strong></h2>
<ul>
<li>We use this to score alignments</li>
<li>Here is an example from class on how to do this
<ul>
<li>sequence 1 = “ACGCTTACCG”</li>
<li>sequence 2 = “AGCCTACCCC”</li>
</ul></li>
<li>Without the help of these functions, you would have to score alignments by hand like this:</li>
</ul>
<p><img src="/blog/2019-12-15-currently-in-class_files/Screen%20Shot%202019-12-15%20at%209.30.04%20PM.png" width="400" height="300" /></p>
<pre class="python"><code>seq1=&quot;ACGCTTACCG&quot;
seq2=&quot;AGCCTACCCC&quot;
 
def match_fun(a,b): # Helper function to define match/mismatch scores
  if a==b:
    score=1 #match score
  else:
    score=-1 #mismatch score
  return score

def needleman(seq1,seq2,gap_penalty=-1): # Needleman-Wunsch algorithm in a funct
  m=len(seq1) #length of horizontal sequence
  n=len(seq2) #length of vertical sequence
  score=np.empty(shape=[n+1,m+1]) #array to hold scores
  for j in range(0, m + 1): score[0][j] = gap_penalty * j
  for i in range(0, n + 1): score[i][0] = gap_penalty * i
  for i in range(1, n + 1):
    for j in range(1, m + 1):
      insert = score[i - 1][j] + gap_penalty
      delete = score[i][j - 1] + gap_penalty
      match = score[i - 1][j - 1] + match_fun(seq1[j-1], seq2[i-1])
      score[i][j] = max(match, delete, insert)
  return score

import numpy as np
needleman(seq1,seq2)</code></pre>
<pre><code>## array([[  0.,  -1.,  -2.,  -3.,  -4.,  -5.,  -6.,  -7.,  -8.,  -9., -10.],
##        [ -1.,   1.,   0.,  -1.,  -2.,  -3.,  -4.,  -5.,  -6.,  -7.,  -8.],
##        [ -2.,   0.,   0.,   1.,   0.,  -1.,  -2.,  -3.,  -4.,  -5.,  -6.],
##        [ -3.,  -1.,   1.,   0.,   2.,   1.,   0.,  -1.,  -2.,  -3.,  -4.],
##        [ -4.,  -2.,   0.,   0.,   1.,   1.,   0.,  -1.,   0.,  -1.,  -2.],
##        [ -5.,  -3.,  -1.,  -1.,   0.,   2.,   2.,   1.,   0.,  -1.,  -2.],
##        [ -6.,  -4.,  -2.,  -2.,  -1.,   1.,   1.,   3.,   2.,   1.,   0.],
##        [ -7.,  -5.,  -3.,  -3.,  -1.,   0.,   0.,   2.,   4.,   3.,   2.],
##        [ -8.,  -6.,  -4.,  -4.,  -2.,  -1.,  -1.,   1.,   3.,   5.,   4.],
##        [ -9.,  -7.,  -5.,  -5.,  -3.,  -2.,  -2.,   0.,   2.,   4.,   4.],
##        [-10.,  -8.,  -6.,  -6.,  -4.,  -3.,  -3.,  -1.,   1.,   3.,   3.]])</code></pre>
</div>
